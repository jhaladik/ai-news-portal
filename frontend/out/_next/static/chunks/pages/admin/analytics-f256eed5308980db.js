(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{9112:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/analytics",function(){return t(3640)}])},3640:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var l=t(5893),n=t(7294),i=t(1163),a=t(6904),r=t(5568),d=t(5577);function c(){let e=(0,i.useRouter)(),[s,t]=(0,n.useState)(null),[c,o]=(0,n.useState)(!0),[x,m]=(0,n.useState)("7d"),[h,g]=(0,n.useState)("all"),u=new r.El;(0,n.useEffect)(()=>{if(!u.getCurrentToken()||!u.isAdmin()){e.push("/login");return}b()},[x,h]);let b=async()=>{try{var e,s,l,n;let i=u.getCurrentToken();if(!i)return;o(!0);let a=await d.Z.getAdminAnalytics(i,x,"all"===h?void 0:h),r={overview:{total_content:a.content.published_content||0,published_today:a.trends.length>0?a.trends[a.trends.length-1].content_published:0,active_subscribers:a.users.active_users||0,newsletter_open_rate:a.newsletters.avg_open_rate||0,avg_ai_confidence:a.content.ai_confidence_avg||0,pipeline_success_rate:1-(a.content.rejection_rate||0)},content_metrics:{by_category:(null===(e=a.content.by_category)||void 0===e?void 0:e.map(e=>({category:e.category,count:e.count,avg_confidence:e.avg_confidence})))||[],by_neighborhood:(null===(s=a.neighborhoods)||void 0===s?void 0:s.map(e=>({neighborhood:e.neighborhood_name,count:e.content_published,subscribers:e.user_count})))||[],by_source:[]},user_engagement:{newsletter_stats:{sent:a.newsletters.total_sent||0,opened:Math.round((a.newsletters.total_sent||0)*(a.newsletters.avg_open_rate||0)),clicked:Math.round((a.newsletters.total_sent||0)*(a.newsletters.avg_click_rate||0)),unsubscribed:0},top_content:[],subscriber_growth:(null===(l=a.trends)||void 0===l?void 0:l.map(e=>({date:e.date,count:e.users_active})))||[]},pipeline_performance:{daily_stats:(null===(n=a.trends)||void 0===n?void 0:n.map(e=>({date:e.date,collected:e.content_published,generated:e.content_published,published:e.content_published})))||[],processing_times:{avg_collection:30,avg_scoring:15,avg_generation:45,avg_validation:20},error_rates:{collection_errors:0,ai_failures:0,validation_failures:0}}};t(r)}catch(e){console.error("Failed to fetch analytics:",e)}finally{o(!1)}},v=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),p=e=>Math.round(100*e)+"%";return c?(0,l.jsx)(a.ZP,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading analytics..."})]})})}):s?(0,l.jsx)(a.ZP,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"\uD83D\uDCCA Analytics Dashboard"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:"Comprehensive insights into your AI news platform performance"})]}),(0,l.jsxs)("div",{className:"mb-8 flex flex-wrap gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Range"}),(0,l.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 bg-white",children:[(0,l.jsx)("option",{value:"1d",children:"Last 24 Hours"}),(0,l.jsx)("option",{value:"7d",children:"Last 7 Days"}),(0,l.jsx)("option",{value:"30d",children:"Last 30 Days"}),(0,l.jsx)("option",{value:"90d",children:"Last 90 Days"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Neighborhood"}),(0,l.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 bg-white",children:[(0,l.jsx)("option",{value:"all",children:"All Neighborhoods"}),(0,l.jsx)("option",{value:"vinohrady",children:"Vinohrady"}),(0,l.jsx)("option",{value:"karlin",children:"Karl\xedn"}),(0,l.jsx)("option",{value:"smichov",children:"Sm\xedchov"}),(0,l.jsx)("option",{value:"nove_mesto",children:"Nov\xe9 Město"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Total Content"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:v(s.overview.total_content)})]}),(0,l.jsx)("div",{className:"text-3xl",children:"\uD83D\uDCF0"})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Published Today"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-green-600",children:s.overview.published_today})]}),(0,l.jsx)("div",{className:"text-3xl",children:"✅"})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Active Subscribers"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:v(s.overview.active_subscribers)})]}),(0,l.jsx)("div",{className:"text-3xl",children:"\uD83D\uDC65"})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Newsletter Open Rate"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:p(s.overview.newsletter_open_rate)})]}),(0,l.jsx)("div",{className:"text-3xl",children:"\uD83D\uDCE7"})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Avg AI Confidence"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:p(s.overview.avg_ai_confidence)})]}),(0,l.jsx)("div",{className:"text-3xl",children:"\uD83E\uDD16"})]})}),(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Pipeline Success"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:p(s.overview.pipeline_success_rate)})]}),(0,l.jsx)("div",{className:"text-3xl",children:"⚙️"})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCA Content by Category"}),(0,l.jsx)("div",{className:"space-y-4",children:s.content_metrics.by_category.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium capitalize",children:e.category.replace("_"," ")}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Confidence: ",p(e.avg_confidence)]})]}),(0,l.jsx)("div",{className:"text-lg font-bold text-blue-600",children:e.count})]},e.category))})]}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83C\uDFD8️ Content by Neighborhood"}),(0,l.jsx)("div",{className:"space-y-4",children:s.content_metrics.by_neighborhood.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:e.neighborhood}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[e.subscribers," subscribers"]})]}),(0,l.jsx)("div",{className:"text-lg font-bold text-green-600",children:e.count})]},e.neighborhood))})]})]}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border mb-8",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCE7 Newsletter Performance"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:v(s.user_engagement.newsletter_stats.sent)}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Sent"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:v(s.user_engagement.newsletter_stats.opened)}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Opened"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:v(s.user_engagement.newsletter_stats.clicked)}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Clicked"})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:v(s.user_engagement.newsletter_stats.unsubscribed)}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Unsubscribed"})]})]})]}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"⚙️ Pipeline Performance"}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Average Processing Times"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"text-lg font-semibold",children:[s.pipeline_performance.processing_times.avg_collection,"s"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Collection"})]}),(0,l.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"text-lg font-semibold",children:[s.pipeline_performance.processing_times.avg_scoring,"s"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Scoring"})]}),(0,l.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"text-lg font-semibold",children:[s.pipeline_performance.processing_times.avg_generation,"s"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Generation"})]}),(0,l.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"text-lg font-semibold",children:[s.pipeline_performance.processing_times.avg_validation,"s"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"Validation"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"\uD83D\uDCC8 Daily Pipeline Activity"}),(0,l.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,l.jsx)("div",{className:"flex items-end space-x-1 h-32",children:s.pipeline_performance.daily_stats.map(e=>(0,l.jsxs)("div",{className:"flex-1 flex flex-col items-center space-y-1",children:[(0,l.jsx)("div",{className:"bg-blue-400 w-full rounded-t",style:{height:"".concat(Math.max(e.published/10*100,5),"%"),minHeight:"4px"},title:"".concat(e.date,": ").concat(e.published," published")}),(0,l.jsx)("div",{className:"text-xs text-gray-600 transform rotate-45 origin-bottom-left",children:e.date.split("-").slice(1).join("/")})]},e.date))})})]})]})]})})}):(0,l.jsx)(a.ZP,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"Failed to load analytics data"}),(0,l.jsx)("button",{onClick:b,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})})})}},1163:function(e,s,t){e.exports=t(3079)}},function(e){e.O(0,[904,888,774,179],function(){return e(e.s=9112)}),_N_E=e.O()}]);