(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[871],{3705:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/content",function(){return s(7359)}])},7359:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var l=s(5893),n=s(7294),a=s(1163),r=s(6904),i=s(5568),d=s(5577);function o(){let e=(0,a.useRouter)(),[t,s]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0),[x,u]=(0,n.useState)("review"),[h,m]=(0,n.useState)({category:void 0,neighborhood:void 0,limit:50,offset:0}),[g,p]=(0,n.useState)(""),[b,y]=(0,n.useState)([]),[f,v]=(0,n.useState)(""),[j,N]=(0,n.useState)(null),[w,C]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(!i.E5.getCurrentToken()||!i.E5.isAdmin()){e.push("/login");return}k()},[x,h]);let k=async()=>{try{if(!i.E5.getCurrentToken())return;c(!0);let e={...h,..."all"!==x&&{status:x}},t=await d.Z.getPublishedContent(e);s(t.content)}catch(e){console.error("Failed to fetch content:",e)}finally{c(!1)}},_=async(e,t,l)=>{try{let n=i.E5.getCurrentToken();if(!n)return;C(e),"approve"===t?(await d.Z.approveContent(n,e),s(t=>t.filter(t=>t.id!==e))):"reject"===t?(console.log("Rejecting ".concat(e," with reason: ").concat(l)),s(t=>t.filter(t=>t.id!==e))):"delete"===t&&(await d.Z.deleteContent(n,e),s(t=>t.filter(t=>t.id!==e)))}catch(e){console.error("Failed to ".concat(t," content:"),e)}finally{C(null)}},E=async()=>{if(f&&0!==b.length)try{let e=i.E5.getCurrentToken();if(!e)return;C("bulk");let t=b.map(t=>"approve"===f?d.Z.approveContent(e,t):"delete"===f?d.Z.deleteContent(e,t):Promise.resolve());await Promise.all(t),s(e=>e.filter(e=>!b.includes(e.id))),y([]),v("")}catch(e){console.error("Bulk action failed:",e)}finally{C(null)}},S=e=>{y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},P=e=>{let t=Math.floor((Date.now()-e)/1e3);return t<60?"".concat(t,"s ago"):t<3600?"".concat(Math.floor(t/60),"m ago"):t<86400?"".concat(Math.floor(t/3600),"h ago"):"".concat(Math.floor(t/86400),"d ago")},A=e=>{switch(e){case"published":return"text-green-600 bg-green-100";case"review":return"text-yellow-600 bg-yellow-100";case"rejected":return"text-red-600 bg-red-100";case"draft":return"text-gray-600 bg-gray-100";default:return"text-blue-600 bg-blue-100"}},D=e=>{switch(e){case"emergency":return"text-red-600 bg-red-100";case"local":return"text-blue-600 bg-blue-100";case"business":return"text-green-600 bg-green-100";case"community":return"text-purple-600 bg-purple-100";case"events":return"text-orange-600 bg-orange-100";default:return"text-gray-600 bg-gray-100"}},M=t.filter(e=>e.title.toLowerCase().includes(g.toLowerCase())||e.content.toLowerCase().includes(g.toLowerCase()));return o?(0,l.jsx)(r.ZP,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading content..."})]})})}):(0,l.jsxs)(r.ZP,{children:[(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"\uD83D\uDCDD Content Management"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:"Review, approve, and manage AI-generated content"})]}),(0,l.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,l.jsx)("div",{className:"border-b border-gray-200",children:(0,l.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"review",label:"Pending Review",count:t.filter(e=>"review"===e.status).length},{key:"published",label:"Published",count:t.filter(e=>"published"===e.status).length},{key:"rejected",label:"Rejected",count:t.filter(e=>"rejected"===e.status).length},{key:"all",label:"All Content",count:t.length}].map(e=>(0,l.jsxs)("button",{onClick:()=>u(e.key),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat(x===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.label,(0,l.jsx)("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-100 rounded-full",children:e.count})]},e.key))})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search content...",value:g,onChange:e=>p(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 w-64"}),(0,l.jsxs)("select",{value:h.category||"all",onChange:e=>m(t=>({...t,category:"all"===e.target.value?void 0:e.target.value})),className:"border border-gray-300 rounded-md px-3 py-2",children:[(0,l.jsx)("option",{value:"all",children:"All Categories"}),(0,l.jsx)("option",{value:"emergency",children:"Emergency"}),(0,l.jsx)("option",{value:"local",children:"Local"}),(0,l.jsx)("option",{value:"business",children:"Business"}),(0,l.jsx)("option",{value:"community",children:"Community"}),(0,l.jsx)("option",{value:"events",children:"Events"})]}),(0,l.jsxs)("select",{value:h.neighborhood||"all",onChange:e=>m(t=>({...t,neighborhood:"all"===e.target.value?void 0:e.target.value})),className:"border border-gray-300 rounded-md px-3 py-2",children:[(0,l.jsx)("option",{value:"all",children:"All Neighborhoods"}),(0,l.jsx)("option",{value:"vinohrady",children:"Vinohrady"}),(0,l.jsx)("option",{value:"karlin",children:"Karl\xedn"}),(0,l.jsx)("option",{value:"smichov",children:"Sm\xedchov"}),(0,l.jsx)("option",{value:"nove_mesto",children:"Nov\xe9 Město"})]})]}),b.length>0&&(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:[b.length," selected"]}),(0,l.jsxs)("select",{value:f,onChange:e=>v(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm",children:[(0,l.jsx)("option",{value:"",children:"Bulk Actions"}),(0,l.jsx)("option",{value:"approve",children:"Approve Selected"}),(0,l.jsx)("option",{value:"delete",children:"Delete Selected"})]}),(0,l.jsx)("button",{onClick:E,disabled:!f||"bulk"===w,className:"px-3 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50",children:"bulk"===w?"Processing...":"Apply"})]})]})]}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,l.jsx)("div",{className:"px-6 py-3 border-b border-gray-200 bg-gray-50",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:b.length===M.length&&M.length>0,onChange:()=>{b.length===t.length?y([]):y(t.map(e=>e.id))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-4"}),(0,l.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[M.length," items"]})]})}),(0,l.jsx)("div",{className:"divide-y divide-gray-200",children:0===M.length?(0,l.jsx)("div",{className:"px-6 py-12 text-center",children:(0,l.jsx)("p",{className:"text-gray-500",children:"No content found matching your criteria."})}):M.map(e=>(0,l.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50",children:(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,l.jsx)("input",{type:"checkbox",checked:b.includes(e.id),onChange:()=>S(e.id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded mt-1"}),(0,l.jsx)("div",{className:"flex-1 min-w-0",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 line-clamp-2",children:e.title}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-600 line-clamp-3",children:e.content}),(0,l.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(A(e.status)),children:e.status}),(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(D(e.category)),children:e.category}),(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-gray-600 bg-gray-100",children:e.neighborhood_name}),(0,l.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-purple-600 bg-purple-100",children:[Math.round(100*e.ai_confidence),"% confidence"]})]}),(0,l.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Created ",P(e.created_at),e.published_at&&(0,l.jsxs)("span",{children:[" • Published ",P(e.published_at)]})]})]}),(0,l.jsxs)("div",{className:"flex space-x-2 ml-4",children:["review"===e.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>_(e.id,"approve"),disabled:w===e.id,className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 disabled:opacity-50",children:w===e.id?"...":"Approve"}),(0,l.jsx)("button",{onClick:()=>_(e.id,"reject","Admin review"),disabled:w===e.id,className:"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 disabled:opacity-50",children:w===e.id?"...":"Reject"})]}),(0,l.jsx)("button",{onClick:()=>N(e),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>_(e.id,"delete"),disabled:w===e.id,className:"px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700 disabled:opacity-50",children:"Delete"})]})]})})]})},e.id))})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,l.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",M.length," of ",t.length," results"]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>m(e=>({...e,offset:Math.max(0,(e.offset||0)-(e.limit||50))})),disabled:!h.offset,className:"px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,l.jsx)("button",{onClick:()=>m(e=>({...e,offset:(e.offset||0)+(e.limit||50)})),disabled:M.length<(h.limit||50),className:"px-3 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})}),j&&(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,l.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-96 overflow-y-auto",children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Edit Content: ",j.title]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Content editing interface would go here. This would include fields for title, content, category, status, etc."}),(0,l.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,l.jsx)("button",{onClick:()=>N(null),className:"px-4 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:"Close"}),(0,l.jsx)("button",{onClick:()=>N(null),className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Save Changes"})]})]})})})]})}},1163:function(e,t,s){e.exports=s(3079)}},function(e){e.O(0,[904,888,774,179],function(){return e(e.s=3705)}),_N_E=e.O()}]);