exports.id=814,exports.ids=[814],exports.modules={3463:(e,t,r)=>{"use strict";r.d(t,{Ho:()=>d,aC:()=>c});var s=r(997),n=r(6689),i=r(3673),a=r(6055),o=r(4492),l=r(9841);let u=(0,n.createContext)(void 0),c=()=>{let e=(0,n.useContext)(u);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},d=({children:e})=>{let[t,r]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1),[g,p]=(0,n.useState)(!1),[f,b]=(0,n.useState)(!0),{showSuccess:y,showError:k}=(0,l.x_)(),w=(0,n.useCallback)(()=>{try{let e=i.E5.getAuthState();r(e.user),d(e.token),m(e.isAuthenticated),p(e.isAdmin)}catch(e){console.error("Error initializing auth state:",e)}finally{b(!1)}},[]),R=(0,n.useCallback)(async e=>{try{let t=await a.Z.login(e);if(t.success&&t.token&&t.user)return i.E5.login(t.token,t.user),r(t.user),d(t.token),m(!0),p("admin"===t.user.role),y("Welcome back!",`Signed in as ${t.user.email}`),t;throw Error(t.message||"Login failed")}catch(e){throw k("Login failed",(0,o.e$)(e)),e}},[y,k]),S=(0,n.useCallback)(()=>{i.E5.logout(),r(null),d(null),m(!1),p(!1),y("Signed out successfully")},[y]);return(0,n.useCallback)(e=>{i.E5.updateUser(e),r(e),p("admin"===e.role)},[]),(0,n.useEffect)(()=>((0,i.uJ)(),w(),i.E5.subscribe(()=>{let e=i.E5.getAuthState();r(e.user),d(e.token),m(e.isAuthenticated),p(e.isAdmin)})),[w]),(0,n.useEffect)(()=>{if(!h||!c)return;let e=setInterval(()=>{i.E5.checkTokenExpiration()},3e5);return()=>clearInterval(e)},[h,c]),(0,n.useEffect)(()=>{let e=()=>{h&&i.E5.checkTokenExpiration()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[h]),s.jsx(u.Provider,{value:{user:t,token:c,login:R,logout:S,isAuthenticated:h,isAdmin:g,loading:f},children:e})}},9841:(e,t,r)=>{"use strict";r.d(t,{VW:()=>u,x_:()=>c});var s=r(997),n=r(6689);let i=(0,n.createContext)(void 0),a=()=>{let e=(0,n.useContext)(i);if(!e)throw Error("useToast must be used within a ToastProvider");return e},o=({toast:e,onRemove:t})=>{let[r,i]=(0,n.useState)(!1),[a,o]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=setTimeout(()=>i(!0),100);return()=>clearTimeout(e)},[]),(0,n.useEffect)(()=>{let t=setTimeout(()=>{l()},e.duration||5e3);return()=>clearTimeout(t)},[e.duration]);let l=(0,n.useCallback)(()=>{o(!0),setTimeout(()=>{t(e.id)},300)},[e.id,t]),u={success:{bg:"bg-green-50",border:"border-green-200",icon:"text-green-400",title:"text-green-800",message:"text-green-700"},error:{bg:"bg-red-50",border:"border-red-200",icon:"text-red-400",title:"text-red-800",message:"text-red-700"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:"text-yellow-400",title:"text-yellow-800",message:"text-yellow-700"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:"text-blue-400",title:"text-blue-800",message:"text-blue-700"}}[e.type],c={success:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),error:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),warning:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),info:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})};return s.jsx("div",{className:`
        max-w-sm w-full ${u.bg} ${u.border} border rounded-lg shadow-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden
        transform transition-all duration-300 ease-in-out
        ${r&&!a?"translate-x-0 opacity-100":"translate-x-full opacity-0"}
      `,children:s.jsx("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start",children:[s.jsx("div",{className:`flex-shrink-0 ${u.icon}`,children:c[e.type]}),(0,s.jsxs)("div",{className:"ml-3 w-0 flex-1 pt-0.5",children:[s.jsx("p",{className:`text-sm font-medium ${u.title}`,children:e.title}),e.message&&s.jsx("p",{className:`mt-1 text-sm ${u.message}`,children:e.message})]}),s.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:(0,s.jsxs)("button",{className:`inline-flex ${u.icon} hover:opacity-75 transition-opacity`,onClick:l,children:[s.jsx("span",{className:"sr-only",children:"Close"}),s.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})})})},l=({toasts:e,onRemove:t})=>s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>s.jsx(o,{toast:e,onRemove:t},e.id))}),u=({children:e})=>{let[t,r]=(0,n.useState)([]),a=(0,n.useCallback)(e=>{let t=Math.random().toString(36).substr(2,9),s={...e,id:t};r(e=>[...e,s])},[]),o=(0,n.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]);return(0,s.jsxs)(i.Provider,{value:{addToast:a,removeToast:o},children:[e,s.jsx(l,{toasts:t,onRemove:o})]})},c=()=>{let{addToast:e}=a();return{showSuccess:(t,r)=>e({type:"success",title:t,message:r}),showError:(t,r)=>e({type:"error",title:t,message:r}),showWarning:(t,r)=>e({type:"warning",title:t,message:r}),showInfo:(t,r)=>e({type:"info",title:t,message:r})}}},6055:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});class s{async makeRequest(e,t={},r){let s={"Content-Type":"application/json"};r&&(s.Authorization=`Bearer ${r}`);try{let r=await fetch(e,{...t,headers:s});if(!r.ok){let e=await r.json().catch(()=>({error:"Request failed",status:r.status}));throw{error:e.error||"Request failed",status:r.status,details:e.details}}return await r.json()}catch(e){if(e&&"object"==typeof e&&"status"in e)throw e;throw{error:"Network error",status:0,details:e instanceof Error?e.message:"Unknown error"}}}async login(e){return this.makeRequest(this.baseURLs.auth,{method:"POST",body:JSON.stringify(e)})}async getPublishedContent(e={}){let t=new URLSearchParams;e.neighborhood&&t.append("neighborhood",e.neighborhood),e.category&&t.append("category",e.category),e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString());let r=`${this.baseURLs.contentList}${t.toString()?`?${t.toString()}`:""}`;return this.makeRequest(r)}async subscribeToNewsletter(e){return this.makeRequest(this.baseURLs.newsletterSignup,{method:"POST",body:JSON.stringify(e)})}async getUserDashboard(e,t={}){let r=new URLSearchParams;t.limit&&r.append("limit",t.limit.toString()),t.offset&&r.append("offset",t.offset.toString()),t.category&&r.append("category",t.category);let s=`${this.baseURLs.userDashboard}${r.toString()?`?${r.toString()}`:""}`;return this.makeRequest(s,{method:"GET"},e)}async getUserPreferences(e){return this.makeRequest(this.baseURLs.userPreferences,{method:"GET"},e)}async updateUserPreferences(e,t){return this.makeRequest(this.baseURLs.userPreferences,{method:"PUT",body:JSON.stringify(t)},e)}async getUserProfile(e){return this.makeRequest(this.baseURLs.userProfile,{method:"GET"},e)}async updateUserProfile(e,t){return this.makeRequest(this.baseURLs.userProfile,{method:"PUT",body:JSON.stringify(t)},e)}async deleteUserAccount(e){return this.makeRequest(`${this.baseURLs.userProfile}?confirm=true`,{method:"DELETE"},e)}async getNewsletterArchive(e,t={}){let r=new URLSearchParams;t.limit&&r.append("limit",t.limit.toString()),t.offset&&r.append("offset",t.offset.toString());let s=`${this.baseURLs.newsletterArchive}${r.toString()?`?${r.toString()}`:""}`;return this.makeRequest(s,{method:"GET"},e)}async trackNewsletterOpen(e,t){return this.makeRequest(`${this.baseURLs.newsletterArchive}/open/${t}`,{method:"POST"},e)}async trackNewsletterClick(e,t){return this.makeRequest(`${this.baseURLs.newsletterArchive}/click/${t}`,{method:"POST"},e)}async getAdminDashboard(e){return this.makeRequest(this.baseURLs.adminDashboard,{method:"GET"},e)}async getAdminAnalytics(e,t="7d",r){let s=new URLSearchParams({timeframe:t});r&&s.append("neighborhood",r);let n=`${this.baseURLs.adminAnalytics}?${s.toString()}`;return this.makeRequest(n,{method:"GET"},e)}async controlPipeline(e,t){return this.makeRequest(this.baseURLs.adminPipeline,{method:"POST",body:JSON.stringify(t)},e)}async getPipelineStatus(e){return this.makeRequest(this.baseURLs.adminPipeline,{method:"GET"},e)}async getContentForEdit(e,t){return this.makeRequest(`${this.baseURLs.contentOverride}/${t}`,{method:"GET"},e)}async overrideContent(e,t,r){return this.makeRequest(`${this.baseURLs.contentOverride}/${t}`,{method:"PUT",body:JSON.stringify(r)},e)}async deleteContent(e,t){return this.makeRequest(`${this.baseURLs.contentOverride}/${t}?confirm=true`,{method:"DELETE"},e)}async createContent(e,t){return this.makeRequest(this.baseURLs.contentCreate,{method:"POST",body:JSON.stringify(t)},e)}async approveContent(e,t){return this.makeRequest(this.baseURLs.contentApprove,{method:"POST",body:JSON.stringify({content_id:t})},e)}async getRSSources(e){return this.makeRequest(this.baseURLs.rssSources,{method:"GET"},e)}async addRSSSource(e,t){return this.makeRequest(this.baseURLs.rssSources,{method:"POST",body:JSON.stringify(t)},e)}async updateRSSSource(e,t,r){return this.makeRequest(`${this.baseURLs.rssSources}/${t}`,{method:"PUT",body:JSON.stringify(r)},e)}async deleteRSSSource(e,t){return this.makeRequest(`${this.baseURLs.rssSources}/${t}?confirm=true`,{method:"DELETE"},e)}async getNewsletterTemplates(){return this.makeRequest(this.baseURLs.newsletterTemplate,{method:"GET"})}async generateNewsletter(e,t){let r=new URLSearchParams({action:"generate",neighborhood_id:t});return this.makeRequest(`${this.baseURLs.newsletterTemplate}?${r.toString()}`,{method:"GET"},e)}async createNewsletterFromTemplate(e,t){return this.makeRequest(this.baseURLs.newsletterTemplate,{method:"POST",body:JSON.stringify(t)},e)}async sendNewsletter(e,t){return this.makeRequest(this.baseURLs.newsletterSend,{method:"POST",body:JSON.stringify(t)},e)}async getNewsletterSendHistory(e){return this.makeRequest(this.baseURLs.newsletterSend,{method:"GET"},e)}constructor(){this.baseURLs={auth:"https://auth-login.jhaladik.workers.dev",contentList:"https://content-list.jhaladik.workers.dev",contentCreate:process.env.CONTENT_CREATE_URL||"https://content-create.jhaladik.workers.dev",contentApprove:process.env.CONTENT_APPROVE_URL||"https://content-approve.jhaladik.workers.dev",contentOverride:process.env.CONTENT_MANUAL_OVERRIDE_URL||"https://content-manual-override.jhaladik.workers.dev",userPreferences:"https://user-preferences.jhaladik.workers.dev",userDashboard:process.env.USER_DASHBOARD_URL||"https://user-dashboard.jhaladik.workers.dev",userProfile:"https://user-profile.jhaladik.workers.dev",newsletterArchive:process.env.NEWSLETTER_ARCHIVE_URL||"https://newsletter-archive.jhaladik.workers.dev",adminDashboard:process.env.ADMIN_DASHBOARD_URL||"https://admin-dashboard.jhaladik.workers.dev",adminAnalytics:process.env.ADMIN_ANALYTICS_URL||"https://admin-analytics.jhaladik.workers.dev",adminPipeline:process.env.ADMIN_PIPELINE_CONTROL_URL||"https://admin-pipeline-control.jhaladik.workers.dev",newsletterSignup:"https://newsletter-signup.jhaladik.workers.dev",newsletterSend:process.env.NEWSLETTER_SEND_URL||"https://newsletter-send.jhaladik.workers.dev",newsletterTemplate:process.env.NEWSLETTER_TEMPLATE_URL||"https://newsletter-template.jhaladik.workers.dev",rssSources:"https://rss-sources-management.jhaladik.workers.dev"}}}let n=new s},3673:(e,t,r)=>{"use strict";r.d(t,{E5:()=>l,El:()=>o,b3:()=>u,uJ:()=>c});let s={get:()=>null,set:e=>{},remove:()=>{}},n={get:()=>null,set:e=>{},remove:()=>{}},i=e=>{try{let t=e.split(".");if(3!==t.length)return null;let r=t[1],s=atob(r.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(s)}catch{return null}},a=e=>{let t=i(e);if(!t)return!0;let r=Math.floor(Date.now()/1e3);return t.exp<r};class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notify(){this.listeners.forEach(e=>e())}getAuthState(){let e=s.get(),t=n.get(),r=!!(e&&!a(e)&&t),i=r&&t?.role==="admin";return{isAuthenticated:r,user:t,token:e,isAdmin:i}}login(e,t){s.set(e),n.set(t),this.notify()}logout(){s.remove(),n.remove(),this.notify()}updateUser(e){n.set(e),this.notify()}isAdmin(){let{isAuthenticated:e,user:t}=this.getAuthState();return e&&t?.role==="admin"}isAuthenticated(){return this.getAuthState().isAuthenticated}getCurrentUser(){return this.getAuthState().user}getCurrentToken(){return this.getAuthState().token}checkTokenExpiration(){let e=s.get();e&&a(e)&&this.logout()}constructor(){this.listeners=[]}}let l=o.getInstance(),u=e=>e?e.name||e.email.split("@")[0]:"Guest",c=()=>{l.checkTokenExpiration()}},4492:(e,t,r)=>{"use strict";r.d(t,{AQ:()=>o,B9:()=>d,DG:()=>a,Ls:()=>i,SI:()=>c,W9:()=>u,e$:()=>h,kR:()=>p,p6:()=>s,uf:()=>m,wc:()=>l});let s=(e,t={})=>{let r=new Date(1e3*e),s=new Date().getTime()-r.getTime(),n=Math.floor(s/6e4),i=Math.floor(s/36e5),a=Math.floor(s/864e5);if(t.relative){if(n<1)return"Just now";if(n<60)return`${n} minute${1===n?"":"s"} ago`;if(i<24)return`${i} hour${1===i?"":"s"} ago`;if(a<7)return`${a} day${1===a?"":"s"} ago`}let o={year:"numeric",month:t.short?"short":"long",day:"numeric"};return t.includeTime&&(o.hour="numeric",o.minute="2-digit",o.hour12=!0),r.toLocaleDateString("en-US",o)},n=(e,t,r="...")=>e.length<=t?e:e.slice(0,t-r.length)+r,i=e=>e.replace(/\b\w/g,e=>e.toUpperCase()),a=e=>i(e.replace(/_/g," ")),o=(e,t=150)=>n(e.replace(/<[^>]*>/g,""),t),l=e=>({draft:"bg-gray-100 text-gray-800",ai_generated:"bg-blue-100 text-blue-800",review:"bg-yellow-100 text-yellow-800",published:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",failed:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800",u=e=>({emergency:"bg-red-100 text-red-800",local:"bg-blue-100 text-blue-800",business:"bg-green-100 text-green-800",community:"bg-purple-100 text-purple-800",events:"bg-orange-100 text-orange-800"})[e]||"bg-gray-100 text-gray-800",c=e=>[...e].sort((e,t)=>"emergency"===e.category&&"emergency"!==t.category?-1:"emergency"===t.category&&"emergency"!==e.category?1:t.created_at-e.created_at),d=(e,t)=>{if(!t.trim())return e;let r=t.toLowerCase();return e.filter(e=>e.title.toLowerCase().includes(r)||e.content.toLowerCase().includes(r)||e.neighborhood_name.toLowerCase().includes(r)||e.category.toLowerCase().includes(r))},h=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){if(e.error)return e.error;if("message"in e&&"string"==typeof e.message)return e.message}return"An unexpected error occurred"},m=e=>new Intl.NumberFormat("en-US").format(e),g=(e,t=1)=>`${(100*e).toFixed(t)}%`,p=e=>g(e)},6814:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(997),n=r(3463),i=r(9841);function a({Component:e,pageProps:t}){return s.jsx(i.VW,{children:s.jsx(n.Ho,{children:s.jsx(e,{...t})})})}r(6764)},6764:()=>{}};