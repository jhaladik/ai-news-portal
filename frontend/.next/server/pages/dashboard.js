"use strict";(()=>{var e={};e.id=26,e.ids=[26,888,660],e.modules={6656:(e,s,t)=>{t.r(s),t.d(s,{config:()=>S,default:()=>k,getServerSideProps:()=>D,getStaticPaths:()=>_,getStaticProps:()=>C,reportWebVitals:()=>P,routeModule:()=>q,unstable_getServerProps:()=>Z,unstable_getServerSideProps:()=>z,unstable_getStaticParams:()=>M,unstable_getStaticPaths:()=>A,unstable_getStaticProps:()=>F});var a={};t.r(a),t.d(a,{default:()=>w});var r=t(7093),l=t(5244),i=t(1323),n=t(2899),d=t.n(n),c=t(6814),o=t(997),x=t(6689),m=t(1163),h=t(115),u=t(3830);let g=["emergency","local","business","community","events"],b=["draft","ai_generated","review","published","rejected","failed"];var p=t(4492),j=t(9767),f=t(9553);let v=({filters:e,neighborhoods:s=[],onFiltersChange:t,showStatus:a=!1,showAdvanced:r=!1,variant:l="sidebar",className:i=""})=>{let[n,d]=(0,x.useState)(e),[c,m]=(0,x.useState)(!1),[h,u]=(0,x.useState)(!1);(0,x.useEffect)(()=>{d(e)},[e]),(0,x.useEffect)(()=>{u(!!(n.neighborhood||n.category||n.status))},[n]);let v=(e,s)=>{let a={...n,[e]:s||void 0};d(a),t(a)},y=()=>{let e={};d(e),t(e)},N=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"space-y-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Neighborhood"}),(0,o.jsxs)("select",{value:n.neighborhood||"",onChange:e=>v("neighborhood",e.target.value),className:"block w-full border border-gray-300 rounded-md px-3 py-2 bg-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Neighborhoods"}),s.map(e=>o.jsx("option",{value:e.slug,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{className:"space-y-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),o.jsx("div",{className:"space-y-2",children:"horizontal"===l?(0,o.jsxs)("select",{value:n.category||"",onChange:e=>v("category",e.target.value),className:"block w-full border border-gray-300 rounded-md px-3 py-2 bg-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Categories"}),g.map(e=>o.jsx("option",{value:e,children:(0,p.DG)(e)},e))]}):(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsxs)("label",{className:"flex items-center",children:[o.jsx("input",{type:"radio",name:"category",value:"",checked:!n.category,onChange:e=>v("category",e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"All Categories"})]}),g.map(e=>(0,o.jsxs)("label",{className:"flex items-center",children:[o.jsx("input",{type:"radio",name:"category",value:e,checked:n.category===e,onChange:e=>v("category",e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),o.jsx("span",{className:"ml-2 text-sm text-gray-700",children:(0,p.DG)(e)})]},e))]})})]}),a&&(0,o.jsxs)("div",{className:"space-y-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,o.jsxs)("select",{value:n.status||"",onChange:e=>v("status",e.target.value),className:"block w-full border border-gray-300 rounded-md px-3 py-2 bg-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Statuses"}),b.map(e=>o.jsx("option",{value:e,children:(0,p.Ls)(e.replace("_"," "))},e))]})]}),h&&o.jsx("div",{className:"pt-4 border-t border-gray-200",children:(0,o.jsxs)(j.Z,{variant:"ghost",size:"sm",onClick:y,className:"w-full",children:[o.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear All Filters"]})})]});return"horizontal"===l?o.jsx("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${i}`,children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:N()})}):"compact"===l?(0,o.jsxs)("div",{className:i,children:[o.jsx("div",{className:"md:hidden mb-4",children:(0,o.jsxs)(j.Z,{variant:"secondary",size:"sm",onClick:()=>m(!c),className:"w-full",children:[o.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z"})}),"Filters",h&&o.jsx("span",{className:"ml-2 bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs",children:(()=>{let e=0;return n.neighborhood&&e++,n.category&&e++,n.status&&e++,e})()})]})}),o.jsx("div",{className:`md:block ${c?"block":"hidden"}`,children:o.jsx(f.Z,{padding:"sm",children:o.jsx("div",{className:"space-y-4",children:N()})})})]}):(0,o.jsxs)("div",{className:i,children:[o.jsx(f.Z,{title:"Filters",padding:"md",children:o.jsx("div",{className:"space-y-6",children:N()})}),h&&o.jsx(f.Z,{className:"mt-4",padding:"sm",children:(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Active Filters"}),(0,o.jsxs)("div",{className:"space-y-1",children:[n.neighborhood&&(0,o.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Neighborhood:"}),o.jsx("span",{className:"font-medium",children:s.find(e=>e.slug===n.neighborhood)?.name||n.neighborhood})]}),n.category&&(0,o.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Category:"}),o.jsx("span",{className:"font-medium",children:(0,p.DG)(n.category)})]}),n.status&&(0,o.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-gray-600",children:"Status:"}),o.jsx("span",{className:"font-medium",children:(0,p.Ls)(n.status.replace("_"," "))})]})]})]})}),r&&o.jsx(f.Z,{className:"mt-4",padding:"sm",children:(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Statistics"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,o.jsxs)("div",{children:[o.jsx("div",{className:"text-lg font-semibold text-blue-600",children:s.length}),o.jsx("div",{className:"text-xs text-gray-600",children:"Neighborhoods"})]}),(0,o.jsxs)("div",{children:[o.jsx("div",{className:"text-lg font-semibold text-green-600",children:g.length}),o.jsx("div",{className:"text-xs text-gray-600",children:"Categories"})]})]})]})})]})};var y=t(3673),N=t(6055);function w(){let e=(0,m.useRouter)(),[s,t]=(0,x.useState)(null),[a,r]=(0,x.useState)(null),[l,i]=(0,x.useState)(null),[n,d]=(0,x.useState)(!0),[c,g]=(0,x.useState)(!1),[b,p]=(0,x.useState)({category:"all",neighborhood:"all",limit:20,offset:0}),j=new y.El,f=async()=>{try{let e=j.getCurrentToken();if(!e)return;d(!0);let[s,a]=await Promise.all([N.Z.getUserProfile(e),N.Z.getUserDashboard(e,{limit:b.limit,offset:b.offset})]);t(s.profile),r(s.statistics),i(a)}catch(s){console.error("Failed to fetch initial data:",s),e.push("/login")}finally{d(!1)}},w=async()=>{try{let e=j.getCurrentToken();if(!e)return;g(!0);let s={limit:b.limit,offset:b.offset,category:"all"!==b.category?b.category:void 0,neighborhood:"all"!==b.neighborhood?b.neighborhood:void 0},t=await N.Z.getUserDashboard(e,s);i(t)}catch(e){console.error("Failed to fetch personalized feed:",e)}finally{g(!1)}},k=e=>{p(e)},C=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),_=e=>{let s=Math.floor((Date.now()-e)/1e3);return s<60?`${s}s ago`:s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:`${Math.floor(s/86400)}d ago`},D=[{id:"vinohrady",name:"Vinohrady",slug:"vinohrady",subscriber_count:245,status:"active",created_at:Date.now()},{id:"karlin",name:"Karl\xedn",slug:"karlin",subscriber_count:189,status:"active",created_at:Date.now()},{id:"smichov",name:"Sm\xedchov",slug:"smichov",subscriber_count:156,status:"active",created_at:Date.now()},{id:"nove_mesto",name:"Nov\xe9 Město",slug:"nove_mesto",subscriber_count:312,status:"active",created_at:Date.now()}];return n?o.jsx(h.ZP,{children:o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading your personalized dashboard..."})]})})}):s&&l?o.jsx(h.ZP,{children:o.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,o.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",s.name||s.email.split("@")[0],"! \uD83D\uDC4B"]}),(0,o.jsxs)("p",{className:"mt-2 text-gray-600",children:["Your personalized Prague news dashboard for ",s.neighborhood_name]})]}),a&&(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Content Views"}),o.jsx("p",{className:"text-2xl font-bold text-blue-600",children:C(a.content_views||0)})]}),o.jsx("div",{className:"text-3xl",children:"\uD83D\uDCD6"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Newsletters Clicked"}),o.jsx("p",{className:"text-2xl font-bold text-green-600",children:C(a.newsletters_clicked||0)})]}),o.jsx("div",{className:"text-3xl",children:"\uD83D\uDCE7"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Open Rate"}),(0,o.jsxs)("p",{className:"text-2xl font-bold text-purple-600",children:[Math.round(100*(a.open_rate||0)),"%"]})]}),o.jsx("div",{className:"text-3xl",children:"\uD83D\uDCCA"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Click Rate"}),(0,o.jsxs)("p",{className:"text-2xl font-bold text-orange-600",children:[Math.round(100*(a.click_rate||0)),"%"]})]}),o.jsx("div",{className:"text-3xl",children:"⭐"})]})})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,o.jsxs)("div",{className:"lg:col-span-1",children:[o.jsx(v,{filters:{neighborhood:b.neighborhood,category:b.category},neighborhoods:D,onFiltersChange:e=>k({...b,neighborhood:e.neighborhood||"all",category:e.category||"all"}),showStatus:!1,showAdvanced:!0,variant:"sidebar"}),(0,o.jsxs)("div",{className:"mt-6 bg-white p-4 rounded-lg shadow-sm border",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Quick Actions"}),(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx("button",{onClick:()=>e.push("/profile"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"\uD83D\uDCDD Edit Profile"}),o.jsx("button",{onClick:()=>e.push("/preferences"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"⚙️ Preferences"}),o.jsx("button",{onClick:()=>e.push("/newsletters"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"\uD83D\uDCE7 Newsletter Archive"})]})]}),l.recent_activity&&l.recent_activity.length>0&&(0,o.jsxs)("div",{className:"mt-6 bg-white p-4 rounded-lg shadow-sm border",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Recent Activity"}),o.jsx("div",{className:"space-y-3",children:l.recent_activity.slice(0,5).map(e=>(0,o.jsxs)("div",{className:"text-sm",children:[o.jsx("p",{className:"text-gray-900",children:e.description}),o.jsx("p",{className:"text-gray-500 text-xs",children:_(e.timestamp)})]},e.id))})]})]}),(0,o.jsxs)("div",{className:"lg:col-span-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Your Personalized News Feed"}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsxs)("button",{onClick:w,disabled:c,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50",children:["\uD83D\uDD04"," Refresh"]}),(0,o.jsxs)("select",{value:b.limit,onChange:e=>k({...b,limit:parseInt(e.target.value),offset:0}),className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[o.jsx("option",{value:10,children:"10 articles"}),o.jsx("option",{value:20,children:"20 articles"}),o.jsx("option",{value:50,children:"50 articles"})]})]})]}),c&&(0,o.jsxs)("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading personalized content..."})]}),!c&&(0,o.jsxs)(o.Fragment,{children:[0===l.content.length?(0,o.jsxs)("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDCF0"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No content found"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your filters or check back later for new content."}),o.jsx("button",{onClick:()=>k({...b,category:"all",neighborhood:"all"}),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Clear Filters"})]}):o.jsx("div",{className:"space-y-6",children:l.content.map(e=>o.jsx(u.Z,{content:e,variant:"default",showActions:!1,className:"hover:shadow-md transition-shadow"},e.id))}),l.content.length>=b.limit&&(0,o.jsxs)("div",{className:"mt-8 flex justify-center space-x-4",children:[o.jsx("button",{onClick:()=>k({...b,offset:Math.max(0,b.offset-b.limit)}),disabled:0===b.offset,className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,o.jsxs)("span",{className:"px-4 py-2 text-sm text-gray-600",children:["Showing ",b.offset+1," - ",Math.min(b.offset+b.limit,b.offset+l.content.length)]}),o.jsx("button",{onClick:()=>k({...b,offset:b.offset+b.limit}),disabled:l.content.length<b.limit,className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]}),a&&a.favorite_categories.length>0&&(0,o.jsxs)("div",{className:"mt-12 bg-white p-6 rounded-lg shadow-sm border",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Favorite Categories"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:a.favorite_categories.map(e=>o.jsx("button",{onClick:()=>k({...b,category:e,offset:0}),className:`px-3 py-1 rounded-full text-sm ${b.category===e?"bg-blue-600 text-white":"bg-blue-100 text-blue-800 hover:bg-blue-200"}`,children:e.replace("_"," ")},e))})]}),l.user_preferences&&(0,o.jsxs)("div",{className:"mt-8 bg-white p-6 rounded-lg shadow-sm border",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Newsletter Preferences"}),o.jsx("button",{onClick:()=>e.push("/preferences"),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Edit Preferences →"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,o.jsxs)("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Frequency:"}),o.jsx("span",{className:"ml-2 capitalize",children:l.user_preferences.notification_frequency})]}),(0,o.jsxs)("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Email:"}),o.jsx("span",{className:`ml-2 ${l.user_preferences.email_enabled?"text-green-600":"text-red-600"}`,children:l.user_preferences.email_enabled?"Enabled":"Disabled"})]}),(0,o.jsxs)("div",{children:[o.jsx("span",{className:"font-medium text-gray-700",children:"Categories:"}),(0,o.jsxs)("span",{className:"ml-2",children:[l.user_preferences.categories.length," selected"]})]})]})]})]})})}):o.jsx(h.ZP,{children:o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load dashboard data"}),o.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})})})}let k=(0,i.l)(a,"default"),C=(0,i.l)(a,"getStaticProps"),_=(0,i.l)(a,"getStaticPaths"),D=(0,i.l)(a,"getServerSideProps"),S=(0,i.l)(a,"config"),P=(0,i.l)(a,"reportWebVitals"),F=(0,i.l)(a,"unstable_getStaticProps"),A=(0,i.l)(a,"unstable_getStaticPaths"),M=(0,i.l)(a,"unstable_getStaticParams"),Z=(0,i.l)(a,"unstable_getServerProps"),z=(0,i.l)(a,"unstable_getServerSideProps"),q=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/dashboard",pathname:"/dashboard",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:a})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")}};var s=require("../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[899,342,814,115,830],()=>t(6656));module.exports=a})();