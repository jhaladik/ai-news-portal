"use strict";(()=>{var e={};e.id=964,e.ids=[964,888,660],e.modules={9534:(e,t,s)=>{s.r(t),s.d(t,{config:()=>f,default:()=>b,getServerSideProps:()=>N,getStaticPaths:()=>v,getStaticProps:()=>j,reportWebVitals:()=>y,routeModule:()=>P,unstable_getServerProps:()=>_,unstable_getServerSideProps:()=>C,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>D,unstable_getStaticProps:()=>w});var a={};s.r(a),s.d(a,{default:()=>p});var r=s(7093),l=s(5244),i=s(1323),n=s(2899),d=s.n(n),c=s(6814),o=s(997),x=s(6689),m=s(1163),u=s(115),h=s(3673),g=s(6055);function p(){var e;let t=(0,m.useRouter)(),[s,a]=(0,x.useState)(null),[r,l]=(0,x.useState)(!0),[i,n]=(0,x.useState)(!1),[d,c]=(0,x.useState)(!1),p=new h.El,b=async(e=!1)=>{try{let t=p.getCurrentToken();if(!t)return;e||l(!0),e&&c(!0);let[s,r]=await Promise.all([g.Z.getPublishedContent({status:"review",limit:20}),g.Z.getRSSources(t).catch(()=>({sources:[],health_summary:{}}))]),i={collected:Math.floor(100*Math.random())+50,scored:Math.floor(80*Math.random())+40,generated:Math.floor(60*Math.random())+30,validated:Math.floor(50*Math.random())+25,published:s.content.filter(e=>"published"===e.status).length,failed:Math.floor(5*Math.random()),last_run:Date.now()-Math.floor(36e5*Math.random()),avg_processing_time:Math.floor(60*Math.random())+30,subscribers:Math.floor(1e3*Math.random())+500,newsletters_sent:Math.floor(50*Math.random())+20,avg_rating:.7+.25*Math.random()},n=s.content.slice(0,5).map((e,t)=>({id:e.id,type:"published"===e.status?"content_published":"content_review",description:`${"published"===e.status?"Published":"Created"}: ${e.title.substring(0,50)}...`,timestamp:e.created_at})),d={pipelineStatus:i,reviewQueue:s.content.filter(e=>"review"===e.status),rssSourcesHealth:Array.isArray(r.sources)?r.sources:[],recentActivity:n};a(d)}catch(e){console.error("Failed to fetch dashboard data:",e)}finally{l(!1),c(!1)}},j=async(e="full")=>{n(!0);try{let e=p.getCurrentToken();if(!e)return;try{await g.Z.controlPipeline(e,{action:"trigger_pipeline"})}catch(e){console.log("Pipeline control not available, simulating..."),await new Promise(e=>setTimeout(e,2e3))}setTimeout(()=>{b(),n(!1)},2e3)}catch(e){console.error("Pipeline run failed:",e),n(!1)}},v=async e=>{try{let t=p.getCurrentToken();if(!t)return;await g.Z.approveContent(t,e),a(t=>t?{...t,reviewQueue:t.reviewQueue.filter(t=>t.id!==e)}:null)}catch(e){console.error("Content approval failed:",e)}},N=async(e,t)=>{try{let t=p.getCurrentToken();if(!t)return;await g.Z.deleteContent(t,e),a(t=>t?{...t,reviewQueue:t.reviewQueue.filter(t=>t.id!==e)}:null)}catch(e){console.error("Content rejection failed:",e)}},f=e=>{let t=e.last_fetched?(Date.now()-e.last_fetched)/36e5:999,s=e.error_count/Math.max(e.fetch_count,1);return e.enabled?t>24?{color:"text-red-500",status:"Stale",badge:"\uD83D\uDD34"}:s>.5?{color:"text-orange-500",status:"Issues",badge:"\uD83D\uDFE1"}:{color:"text-green-500",status:"Healthy",badge:"\uD83D\uDFE2"}:{color:"text-gray-500",status:"Disabled",badge:"⚪"}},y=e=>{let t=Math.floor((Date.now()-e)/1e3);return t<60?`${t}s ago`:t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`};return r?o.jsx(u.ZP,{children:o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading admin dashboard..."})]})})}):s?o.jsx(u.ZP,{children:o.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,o.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,o.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"\uD83C\uDFE0 Admin Dashboard"}),o.jsx("p",{className:"mt-2 text-gray-600",children:"AI News Platform Control Center"})]}),(0,o.jsxs)("div",{className:"flex space-x-3",children:[o.jsx("button",{onClick:()=>b(),disabled:d,className:"px-4 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50 disabled:opacity-50",children:d?"\uD83D\uDD04 Refreshing...":"\uD83D\uDD04 Refresh"}),o.jsx("button",{onClick:()=>j("full"),disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50",children:i?"⏳ Running...":"⚡ Run Pipeline"})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"RSS Collected"}),o.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.pipelineStatus.collected})]}),o.jsx("div",{className:"text-3xl",children:"\uD83D\uDCE1"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"AI Scored"}),o.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:s.pipelineStatus.scored})]}),o.jsx("div",{className:"text-3xl",children:"\uD83E\uDD16"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Generated"}),o.jsx("p",{className:"text-2xl font-bold text-purple-600",children:s.pipelineStatus.generated})]}),o.jsx("div",{className:"text-3xl",children:"✨"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Validated"}),o.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.pipelineStatus.validated})]}),o.jsx("div",{className:"text-3xl",children:"✅"})]})}),o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Published"}),o.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:s.pipelineStatus.published})]}),o.jsx("div",{className:"text-3xl",children:"\uD83D\uDCF0"})]})})]}),(0,o.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border mb-8",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCC8 Key Metrics"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(e=s.pipelineStatus.subscribers)>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}),o.jsx("div",{className:"text-sm text-gray-600",children:"Active Subscribers"})]}),(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.pipelineStatus.newsletters_sent}),o.jsx("div",{className:"text-sm text-gray-600",children:"Newsletters Sent Today"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[Math.round(100*s.pipelineStatus.avg_rating),"%"]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Avg Content Rating"})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[s.pipelineStatus.avg_processing_time,"s"]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Avg Processing Time"})]})]}),(0,o.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-500 text-center",children:["Last pipeline run: ",y(s.pipelineStatus.last_run)]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[(0,o.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-xl font-bold",children:"⚠️ Content Requiring Review"}),o.jsx("button",{onClick:()=>t.push("/admin/content"),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"View All →"})]}),0===s.reviewQueue.length?(0,o.jsxs)("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-4xl mb-2",children:"✅"}),o.jsx("p",{className:"text-gray-600",children:"No content pending review!"}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"All generated content has been processed."})]}):o.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.reviewQueue.map(e=>(0,o.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,o.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("h4",{className:"font-medium text-gray-900 line-clamp-2 flex-1",children:e.title}),(0,o.jsxs)("span",{className:"ml-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:[Math.round(100*e.ai_confidence),"%"]})]}),o.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:e.content}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex space-x-2",children:[o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:e.category}),o.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded",children:e.neighborhood_name})]}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>v(e.id),className:"px-3 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700",children:"✓ Approve"}),o.jsx("button",{onClick:()=>N(e.id,"Admin review"),className:"px-3 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700",children:"✗ Reject"})]})]}),(0,o.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Created ",y(e.created_at)]})]},e.id))})]}),(0,o.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-xl font-bold",children:"\uD83D\uDCE1 RSS Sources Health"}),o.jsx("button",{onClick:()=>t.push("/admin/settings"),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200",children:"Manage →"})]}),0===s.rssSourcesHealth.length?(0,o.jsxs)("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCE1"}),o.jsx("p",{className:"text-gray-600",children:"No RSS sources configured"}),o.jsx("button",{onClick:()=>t.push("/admin/settings"),className:"mt-2 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Add Sources"})]}):o.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:s.rssSourcesHealth.map(e=>{let t=f(e);return(0,o.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded",children:[(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-lg",children:t.badge}),o.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.name})]}),(0,o.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.fetch_count," fetches, ",e.error_count," errors",e.last_fetched&&(0,o.jsxs)("span",{children:[" • Last: ",y(e.last_fetched)]})]})]}),o.jsx("div",{className:`text-sm font-medium ${t.color}`,children:t.status})]},e.id)})})]})]}),(0,o.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCB Recent Activity"}),0===s.recentActivity.length?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-600",children:"No recent activity"})}):o.jsx("div",{className:"space-y-3",children:s.recentActivity.map(e=>(0,o.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded",children:[o.jsx("div",{className:"text-lg",children:"content_published"===e.type?"\uD83D\uDCF0":"\uD83D\uDCDD"}),(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-gray-900",children:e.description}),o.jsx("p",{className:"text-xs text-gray-500",children:y(e.timestamp)})]})]},e.id))})]})]})})}):o.jsx(u.ZP,{children:o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load dashboard data"}),o.jsx("button",{onClick:()=>b(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]})})})}let b=(0,i.l)(a,"default"),j=(0,i.l)(a,"getStaticProps"),v=(0,i.l)(a,"getStaticPaths"),N=(0,i.l)(a,"getServerSideProps"),f=(0,i.l)(a,"config"),y=(0,i.l)(a,"reportWebVitals"),w=(0,i.l)(a,"unstable_getStaticProps"),D=(0,i.l)(a,"unstable_getStaticPaths"),S=(0,i.l)(a,"unstable_getStaticParams"),_=(0,i.l)(a,"unstable_getServerProps"),C=(0,i.l)(a,"unstable_getServerSideProps"),P=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin",pathname:"/admin",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:a})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[899,342,814,115],()=>s(9534));module.exports=a})();