"use strict";(()=>{var e={};e.id=577,e.ids=[577,888,660],e.modules={4811:(e,t,s)=>{s.r(t),s.d(t,{config:()=>f,default:()=>b,getServerSideProps:()=>v,getStaticPaths:()=>j,getStaticProps:()=>y,reportWebVitals:()=>N,routeModule:()=>P,unstable_getServerProps:()=>k,unstable_getServerSideProps:()=>C,unstable_getStaticParams:()=>_,unstable_getStaticPaths:()=>w,unstable_getStaticProps:()=>S});var a={};s.r(a),s.d(a,{default:()=>p});var r=s(7093),l=s(5244),n=s(1323),i=s(2899),d=s.n(i),o=s(6814),c=s(997),m=s(6689),x=s(1163),u=s(115),h=s(3673),g=s(6055);function p(){(0,x.useRouter)();let[e,t]=(0,m.useState)("rss"),[s,a]=(0,m.useState)([]),[r,l]=(0,m.useState)(null),[n,i]=(0,m.useState)(!0),[d,o]=(0,m.useState)(!1),[p,b]=(0,m.useState)(!1),[y,j]=(0,m.useState)({name:"",url:"",category_hint:"local",neighborhood_id:"",priority:1}),v=new h.El,f=async(e,t)=>{try{let s=v.getCurrentToken();if(!s)return;await g.Z.updateRSSSource(s,e,{enabled:t}),a(s=>s.map(s=>s.id===e?{...s,enabled:t}:s))}catch(e){console.error("Failed to toggle RSS source:",e)}},N=async()=>{try{let e=v.getCurrentToken();if(!e)return;o(!0);let t=await g.Z.addRSSSource(e,y);a(e=>[...e,t.source]),j({name:"",url:"",category_hint:"local",neighborhood_id:"",priority:1}),b(!1)}catch(e){console.error("Failed to add RSS source:",e)}finally{o(!1)}},S=async e=>{if(confirm("Are you sure you want to delete this RSS source?"))try{let t=v.getCurrentToken();if(!t)return;await g.Z.deleteRSSSource(t,e),a(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete RSS source:",e)}},w=async()=>{try{o(!0),console.log("Settings saved:",r),await new Promise(e=>setTimeout(e,1e3))}catch(e){console.error("Failed to save settings:",e)}finally{o(!1)}},_=e=>{let t=Math.floor((Date.now()-e)/1e3);return t<60?`${t}s ago`:t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`},k=e=>{let t=e.error_count/Math.max(e.fetch_count,1),s=e.last_fetched?(Date.now()-e.last_fetched)/36e5:999;return e.enabled?s>24||t>.5?"text-red-500":t>.2?"text-yellow-500":"text-green-500":"text-gray-500"};return n?c.jsx(u.ZP,{children:c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,c.jsxs)("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading settings..."})]})})}):c.jsx(u.ZP,{children:c.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,c.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,c.jsxs)("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"⚙️ System Settings"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Configure RSS sources, AI parameters, and system preferences"})]}),c.jsx("div",{className:"mb-8",children:c.jsx("div",{className:"border-b border-gray-200",children:c.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"rss",label:"RSS Sources",icon:"\uD83D\uDCE1"},{key:"ai",label:"AI Settings",icon:"\uD83E\uDD16"},{key:"newsletter",label:"Newsletter",icon:"\uD83D\uDCE7"},{key:"system",label:"System",icon:"⚙️"}].map(s=>(0,c.jsxs)("button",{onClick:()=>t(s.key),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${e===s.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[c.jsx("span",{children:s.icon}),c.jsx("span",{children:s.label})]},s.key))})})}),"rss"===e&&c.jsx("div",{className:"space-y-6",children:(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"RSS Sources"}),c.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"➕ Add Source"})]}),p&&(0,c.jsxs)("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Add New RSS Source"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),c.jsx("input",{type:"text",value:y.name,onChange:e=>j(t=>({...t,name:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"e.g., Prague City News"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RSS URL"}),c.jsx("input",{type:"url",value:y.url,onChange:e=>j(t=>({...t,url:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"https://example.com/rss"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,c.jsxs)("select",{value:y.category_hint,onChange:e=>j(t=>({...t,category_hint:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[c.jsx("option",{value:"local",children:"Local"}),c.jsx("option",{value:"business",children:"Business"}),c.jsx("option",{value:"community",children:"Community"}),c.jsx("option",{value:"events",children:"Events"}),c.jsx("option",{value:"emergency",children:"Emergency"})]})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Neighborhood"}),(0,c.jsxs)("select",{value:y.neighborhood_id,onChange:e=>j(t=>({...t,neighborhood_id:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[c.jsx("option",{value:"",children:"All neighborhoods"}),c.jsx("option",{value:"vinohrady",children:"Vinohrady"}),c.jsx("option",{value:"karlin",children:"Karl\xedn"}),c.jsx("option",{value:"smichov",children:"Sm\xedchov"}),c.jsx("option",{value:"nove_mesto",children:"Nov\xe9 Město"})]})]})]}),(0,c.jsxs)("div",{className:"mt-4 flex space-x-3",children:[c.jsx("button",{onClick:N,disabled:!y.name||!y.url||d,className:"px-4 py-2 bg-green-600 text-white rounded-md text-sm hover:bg-green-700 disabled:opacity-50",children:d?"Adding...":"Add Source"}),c.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:"Cancel"})]})]}),c.jsx("div",{className:"space-y-4",children:0===s.length?(0,c.jsxs)("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-4xl mb-2",children:"\uD83D\uDCE1"}),c.jsx("p",{className:"text-gray-600",children:"No RSS sources configured"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add your first RSS source to start collecting content."})]}):s.map(e=>(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[c.jsx("div",{className:"flex-1",children:(0,c.jsxs)("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`text-lg ${k(e)}`,children:e.enabled?"\uD83D\uDFE2":"⚪"}),(0,c.jsxs)("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),c.jsx("p",{className:"text-sm text-gray-600 truncate max-w-md",children:e.url}),(0,c.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[(0,c.jsxs)("span",{children:["Category: ",e.category_hint]}),(0,c.jsxs)("span",{children:["Fetches: ",e.fetch_count]}),(0,c.jsxs)("span",{children:["Errors: ",e.error_count]}),e.last_fetched&&(0,c.jsxs)("span",{children:["Last: ",_(e.last_fetched)]})]})]})]})}),(0,c.jsxs)("div",{className:"flex items-center space-x-3",children:[c.jsx("button",{onClick:()=>f(e.id,!e.enabled),className:`px-3 py-1 rounded text-sm ${e.enabled?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200":"bg-green-100 text-green-800 hover:bg-green-200"}`,children:e.enabled?"Disable":"Enable"}),c.jsx("button",{onClick:()=>S(e.id),className:"px-3 py-1 bg-red-100 text-red-800 rounded text-sm hover:bg-red-200",children:"Delete"})]})]},e.id))})]})}),"ai"===e&&r&&(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"AI Configuration"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"OpenAI Model"}),(0,c.jsxs)("select",{value:r.ai.openai_model,onChange:e=>l(t=>t?{...t,ai:{...t.ai,openai_model:e.target.value}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[c.jsx("option",{value:"gpt-4-turbo",children:"GPT-4 Turbo"}),c.jsx("option",{value:"gpt-4",children:"GPT-4"}),c.jsx("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confidence Threshold (",Math.round(100*r.ai.confidence_threshold),"%)"]}),c.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:r.ai.confidence_threshold,onChange:e=>l(t=>t?{...t,ai:{...t.ai,confidence_threshold:parseFloat(e.target.value)}}:null),className:"w-full"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum confidence score for auto-approval"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Content Length"}),c.jsx("input",{type:"number",value:r.ai.max_content_length,onChange:e=>l(t=>t?{...t,ai:{...t.ai,max_content_length:parseInt(e.target.value)}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum characters for generated content"})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Generation Temperature (",r.ai.generation_temperature,")"]}),c.jsx("input",{type:"range",min:"0",max:"2",step:"0.1",value:r.ai.generation_temperature,onChange:e=>l(t=>t?{...t,ai:{...t.ai,generation_temperature:parseFloat(e.target.value)}}:null),className:"w-full"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Higher values = more creative, lower = more focused"})]})]}),c.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:c.jsx("button",{onClick:w,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50",children:d?"Saving...":"Save AI Settings"})})]}),"newsletter"===e&&r&&(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Newsletter Configuration"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Send Time"}),c.jsx("input",{type:"time",value:r.newsletter.default_send_time,onChange:e=>l(t=>t?{...t,newsletter:{...t.newsletter,default_send_time:e.target.value}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch Size"}),c.jsx("input",{type:"number",value:r.newsletter.batch_size,onChange:e=>l(t=>t?{...t,newsletter:{...t.newsletter,batch_size:parseInt(e.target.value)}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Emails sent per batch"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sender Email"}),c.jsx("input",{type:"email",value:r.newsletter.sender_email,onChange:e=>l(t=>t?{...t,newsletter:{...t.newsletter,sender_email:e.target.value}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reply-To Email"}),c.jsx("input",{type:"email",value:r.newsletter.reply_to_email,onChange:e=>l(t=>t?{...t,newsletter:{...t.newsletter,reply_to_email:e.target.value}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),c.jsx("div",{className:"md:col-span-2",children:(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:r.newsletter.enabled,onChange:e=>l(t=>t?{...t,newsletter:{...t.newsletter,enabled:e.target.checked}}:null),className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Newsletter sending enabled"})]})})]}),c.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:c.jsx("button",{onClick:w,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50",children:d?"Saving...":"Save Newsletter Settings"})})]}),"system"===e&&r&&(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"System Configuration"}),(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Pipeline Settings"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Auto-Approve Threshold (",Math.round(100*r.pipeline.auto_approve_threshold),"%)"]}),c.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:r.pipeline.auto_approve_threshold,onChange:e=>l(t=>t?{...t,pipeline:{...t.pipeline,auto_approve_threshold:parseFloat(e.target.value)}}:null),className:"w-full"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Daily Content"}),c.jsx("input",{type:"number",value:r.pipeline.max_daily_content,onChange:e=>l(t=>t?{...t,pipeline:{...t.pipeline,max_daily_content:parseInt(e.target.value)}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retry Attempts"}),c.jsx("input",{type:"number",value:r.pipeline.retry_attempts,onChange:e=>l(t=>t?{...t,pipeline:{...t.pipeline,retry_attempts:parseInt(e.target.value)}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),c.jsx("div",{className:"flex items-center",children:(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:r.pipeline.parallel_processing,onChange:e=>l(t=>t?{...t,pipeline:{...t.pipeline,parallel_processing:e.target.checked}}:null),className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Parallel processing"})]})})]})]}),(0,c.jsxs)("div",{className:"pt-6 border-t border-gray-200",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Notifications"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Email"}),c.jsx("input",{type:"email",value:r.notifications.admin_email,onChange:e=>l(t=>t?{...t,notifications:{...t.notifications,admin_email:e.target.value}}:null),className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,c.jsxs)("div",{className:"space-y-2",children:[(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:r.notifications.error_notifications,onChange:e=>l(t=>t?{...t,notifications:{...t.notifications,error_notifications:e.target.checked}}:null),className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Error notifications"})]}),(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:r.notifications.daily_reports,onChange:e=>l(t=>t?{...t,notifications:{...t.notifications,daily_reports:e.target.checked}}:null),className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Daily reports"})]}),(0,c.jsxs)("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:r.notifications.threshold_alerts,onChange:e=>l(t=>t?{...t,notifications:{...t.notifications,threshold_alerts:e.target.checked}}:null),className:"h-4 w-4 text-blue-600 border-gray-300 rounded mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Threshold alerts"})]})]})]})]})]}),c.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:c.jsx("button",{onClick:w,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-50",children:d?"Saving...":"Save System Settings"})})]})]})})})}let b=(0,n.l)(a,"default"),y=(0,n.l)(a,"getStaticProps"),j=(0,n.l)(a,"getStaticPaths"),v=(0,n.l)(a,"getServerSideProps"),f=(0,n.l)(a,"config"),N=(0,n.l)(a,"reportWebVitals"),S=(0,n.l)(a,"unstable_getStaticProps"),w=(0,n.l)(a,"unstable_getStaticPaths"),_=(0,n.l)(a,"unstable_getStaticParams"),k=(0,n.l)(a,"unstable_getServerProps"),C=(0,n.l)(a,"unstable_getServerSideProps"),P=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/settings",pathname:"/admin/settings",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:a})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[899,342,814,115],()=>s(4811));module.exports=a})();